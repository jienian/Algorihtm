# 第1章 常见数据结构
## 1.2 链表 单向链表
``` java
private class LinkNode {
    int val;// 节点中存储的数据。
    LinkNode next;// 指向下一个节点的指针。

    public LinkNode(int val, LinkNode next) {
        this.val = val;
        this.next = next;
    }
}

# 单向链表的插入
// 在链表中插入节点。
public void insert(int index, int val) {
    if (index == 0) {// 插入的是头节点。
        head = new LinkNode(val, head);// 创建头节点赋值给head 。
        if (size == 0)// 如果之前链表为空，让tail指向head 。
            tail = head;
    } else if (index == size) {// 在链表末尾添加
        tail.next = new LinkNode(val, null);// 创建尾节点。
        tail = tail.next;// 更新尾节点。
    } else {// 在中间添加。
        LinkNode preNode = findPre(index);// 查找 index 节点的前一个节点。
        preNode.next = new LinkNode(val, preNode.next);// 添加新节点。
    }
    size++;// 节点个数加 1 。
}

# 单向链表的删除

// 删除节点。
public int remove(int index) {
    if (size == 0)
        throw new IllegalStateException("链表是空的，没法删除……");
    LinkNode delete;// 待删除的节点。
    if (index == 0) {// 删除的是头节点。
        delete = head;// 记录待删除的节点。
        head = head.next;// 更新 head 节点。
        if (head == null)// 如果链表为空，让 tail 也为空。
            tail = null;
    } else {// 删除的不是头节点。
        LinkNode preNode = findPre(index);// 查找删除节点的前一个节点。
        if (index == size - 1) {// 删除的是尾节点。
            delete = preNode.next;
            preNode.next = null;// 删除尾节点。
            tail = preNode;// 更新尾节点。
        } else {// 删除的是中间节点。
            delete = preNode.next;
            preNode.next = delete.next;// 删除节点。
        }
    }
    delete.next = delete;// gc，自己指向自己。
    size--;// 节点个数减 1 。
    return delete.val;// 返回删除节点的值。
}

# 完整代码

private LinkNode head;// 头节点。
private LinkNode tail;// 尾节点。
private int size;// 链表的长度。

// 在尾部添加节点。
public void add(int val) {
    insert(size, val);
}

// 删除头节点。
public int poll() {
    return remove(0);
}

// 在链表中插入节点。
public void insert(int index, int val) {
    if (index == 0) {// 插入的是头节点。
        head = new LinkNode(val, head);// 创建头节点赋值给 head 。
        if (size == 0)// 如果之前链表为空，让 ail指向 head 。
            tail = head;
    } else if (index == size) {// 在链表末尾添加
        tail.next = new LinkNode(val, null);// 创建尾节点。
        tail = tail.next;// 更新尾节点。
    } else {// 不在末尾添加。
        LinkNode preNode = findPre(index);// 查找 index 节点的前一个节点。
        preNode.next = new LinkNode(val, preNode.next);// 添加新节点。
    }
    size++;// 节点个数加1。
}

// 删除节点。
public int remove(int index) {
    if (size == 0)
        throw new IllegalStateException("链表是空的，没法删除……");
    LinkNode delete;// 待删除的节点。
    if (index == 0) {// 删除的是头节点。
        delete = head;// 记录待删除的节点。
        head = head.next;// 更新 head 节点。
        if (head == null)// 如果链表为空，让 tail 也为空。
            tail = null;
    } else {// 删除的不是头节点。
        LinkNode preNode = findPre(index);// 查找删除节点的前一个节点。
        if (index == size - 1) {// 删除的是尾节点。
            delete = preNode.next;
            preNode.next = null;// 删除尾节点。
            tail = preNode;// 更新尾节点。
        } else {// 删除的是中间节点。
            delete = preNode.next;
            preNode.next = delete.next;// 删除节点。
        }
    }
    delete.next = delete;// 自己指向自己。
    size--;// 节点个数减1。
    return delete.val;// 返回删除节点的值。
}

// 查找 index 节点的前一个节点。
LinkNode findPre(int index) {
    // index 必须是有效的，不能越界。查找前一个，index可以等于size。
    if (index < 0 || index > size)
        throw new IndexOutOfBoundsException("越界了……");
    if (index == 0)// 头节点的前一个是空节点。
        return null;
    LinkNode preNode = head;
    for (int i = 0; i < index - 1; i++)
        preNode = preNode.next;
    return preNode;
}

// 节点的个数。
public int size() {
    return size;
}

// 清空链表。
public void clear() {
    while (head != null) {
        LinkNode next = head.next;
        head.next = head;// 自己指向自己。
        head = next;
    }
    tail = null;
    size = 0;
}

# 这样在添加和删除的时候就不需要在判断是否是头节点了，代码如下
private LinkNode dummyNode = new LinkNode(-1, null);// 哑节点。
private int size;// 链表的长度。

// 在尾部添加节点。
public void add(int val) {
    insert(size, val);
}

// 删除头节点
public int poll() {
    return remove(0);
}

// 在链表中插入节点。
public void insert(int index, int val) {
    LinkNode preNode = findPre(index);// 查找 index 节点的前一个节点。
    preNode.next = new LinkNode(val, preNode.next);// 添加新节点。
    size++;// 节点个数加1。
}

// 删除节点。
public int remove(int index) {
    if (size == 0)
        throw new IllegalStateException("链表是空的，没法删除……");
    LinkNode preNode = findPre(index);// 查找删除节点的前一个节点。
    LinkNode delete = preNode.next;// 记录待删除的节点。
    preNode.next = delete.next;// 删除节点。
    delete.next = delete;// 自己指向自己。
    size--;// 节点个数减1 。
    return delete.val;// 返回删除节点的值。
}

// 查找 index 节点的前一个节点。
LinkNode findPre(int index) {
    // index 必须是有效的，不能越界。查找前一个，index可以等于size。
    if (index < 0 || index > size)
        throw new IndexOutOfBoundsException("越界了……");
    LinkNode preNode = dummyNode;
    for (int i = 0; i < index; i++)
        preNode = preNode.next;
    return preNode;
}

// 节点的个数。
public int size() {
    return size;
}

// 清空链表。
public void clear() {
    LinkNode cur = dummyNode.next;
    while (cur != null) {
        LinkNode next = cur.next;
        cur.next = cur;// 自己指向自己。
        cur = next;
    }
    dummyNode.next = null;
    size = 0;
}


```
 

